<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Open Data &amp; Docker Basis :: Programmeren Gevorderd 3 (BETA)</title>
    <meta name="generator" content="Antora 3.1.14">
    <link rel="stylesheet" href="../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="#">Programmeren Gevorderd 3 (BETA)</a>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
      
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
          <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="#">Producten</a>
              <div class="navbar-dropdown">
                  <a class="navbar-item" target="_blank" href="https://learn.microsoft.com/en-us/cli/azure/">Azure CLI</a>
                  <a class="navbar-item" target="_blank" href="https://www.docker.com/products/docker-desktop">Docker Desktop</a>
                  <a class="navbar-item" target="_blank" href="https://desktop.github.com/download">GitHub Desktop</a>
                  <a class="navbar-item" target="_blank" href="https://www.mysql.com/products/workbench">MySQL Workbench</a>
                  <a class="navbar-item" target="_blank" href="https://www.postman.com/downloads/">Postman</a>
                  <a class="navbar-item" target="_blank" href="https://www.jetbrains.com/rider/download">Rider</a>
                  <a class="navbar-item" target="_blank" href="https://code.visualstudio.com/download">VS Code</a>
              </div>
          </div>
          <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="#">Diensten</a>
              <div class="navbar-dropdown">
                  <a class="navbar-item" target="_blank" href="https://dev.azure.com/hogent-web4-stefancourteaux/">Azure DevOps</a>
                  <a class="navbar-item" target="_blank" href="https://portal.azure.com">Azure Portal</a>
                  <a class="navbar-item" target="_blank" href="https://chamilo.hogent.be">Chamilo</a>
                  <a class="navbar-item" target="_blank" href="https://github.com">GitHub</a>
                  <a class="navbar-item" target="_blank" href="https://jwt.io">JWT.io</a>                  
                  <a class="navbar-item" target="_blank" href="https://dotnet.microsoft.com">MS Docs</a>
              </div>
          </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="pg3" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="index.html">Gevorderd 3</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">ShipIt App üì¶Ô∏è</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-cloud-connected.html">Cloud Connected</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-microservices.html">Microservices</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-az-devops.html">Iteratief Ontwikkelen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-cosmos.html">Cosmos &amp; Options Pattern</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="07-blob.html">Blob Storage &amp; PDF</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-middleware.html">Middleware &amp; Extensions</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="08-open-data-2526.html">Open Data</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="09-auth-2526.html">Authenticatie</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="09-auth-2526-2.html">Autorisatie</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="10-technisch.html">Technische Lessen</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="08-docker-2526.html">Docker</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="06-02-secret-management.html">Secret Management</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="08-testing-2526.html">Testing Pyramid</a>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">CI/CD</span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="80-lesopnames-2526S2.html">Lesopnames üì∫</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="00-geen-toegang.html">Geen Azure Toegang üò±</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="03-git.html">Git Gebruik ü•≤</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="99-tips.html">Extra Referenties üßê</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Gevorderd 3</span>
    <span class="version"></span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="index.html">Gevorderd 3</a></div>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Gevorderd 3</a></li>
    <li>ShipIt App üì¶Ô∏è</li>
    <li><a href="08-open-data-2526.html">Open Data</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Open Data &amp; Docker Basis</h1>
<div class="sect1">
<h2 id="_doel_van_deze_les"><a class="anchor" href="#_doel_van_deze_les"></a>Doel van deze les</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Concept Open Data introduceren.</p>
</li>
<li>
<p>Nut en werking van Docker.</p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="_een_open_data_api_gebruiken"><a class="anchor" href="#_een_open_data_api_gebruiken"></a>Een Open Data Api Gebruiken</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vaak zal de software die je bouwt gedeeltelijk, of volledig, steunen op api&#8217;s van derde partijen. Bepaalde datasets zijn, al dan niet door de EU verplicht, vrij beschikbaar via api. Dit heet <em>Open Data</em>.</p>
</div>
<div class="paragraph">
<p>Open data kan ook beschikbaar gesteld worden onder de vorm van gestructureerde bestanden of databanken. In dit voorbeeld zullen we een api gebruiken. Het aanroepen van api&#8217;s - of die nu intern, extern, of open data van aard zijn - verloopt technisch altijd op ongeveer dezelfde manier.</p>
</div>
<div class="paragraph">
<p>Doorgaans zullen moderne systemen JSON berichten uitwisselen. Oudere systemen zullen vaak steunen op XML. Naargelang de sector waarin je werkt, kan het zijn dat er andere gestructureerde formaten zoals <a href="https://service.unece.org/trade/untdid/d00a/trmd/coarri_c.htm">UN/EDIFACT</a> gebruikt worden.</p>
</div>
<div class="paragraph">
<p>In dit voorbeeld zullen een Open Data api van de Franse overheid gebruiken. De <a href="https://geoservices.ign.fr/documentation/services/services-geoplateforme/autocompletion">SERVICE G√âOPLATEFORME D‚ÄôAUTOCOMPL√âTION</a> laat ons toe een adres in Frankrijk op te zoeken op basis van vage zoektermen en geldige adressen terug te krijgen. Dit kan heel interessant zijn voor een bedrijf dat pakjes levert.</p>
</div>
<div class="paragraph">
<p>We kunnen dit integreren in het ShipIt project. We kunnen ongeldige adressen verwerpen bij het aanmaken van een label. Zo vermijden we leveringspogingen op een ongeldig adres.</p>
</div>
<div class="literalblock">
<div class="title">Voorbeeld Request</div>
<div class="content">
<pre>https://data.geopf.fr/geocodage/completion/?text=12, Rue de rivoli, Paris&amp;type=StreetAddress&amp;maximumResponses=3</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Voorbeeld Response</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "status": "OK",
    "results": [
        {
            "x": 2.35995,
            "y": 48.855602,
            "country": "StreetAddress",
            "city": "Paris",
            "oldcity": "",
            "kind": "housenumber",
            "zipcode": "75004",
            "street": "Rue de Rivoli",
            "metropole": true,
            "fulltext": "12 Rue de Rivoli, 75004 Paris",
            "classification": 7
        },
        ...
    ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We maken een klasse aan die het contract van de FR api voorstelt. We nemen enkel de velden op die ons interesseren.</p>
</div>
<div class="listingblock">
<div class="title">ShipIt.Label.Api/AddressResponseContract.cs</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-c# hljs" data-lang="c#">public class AddressResponseContract
{
    public List&lt;Feature&gt; Resu { get; set; }
}

public class Feature{
    public Geometry Geometry { get; set; }
    public Properties Properties { get; set; }
}

public class Geometry
{
    public double[] Coordinates { get; set; }
}

public class Properties
{
    public string Label { get; set; }
    public double Score { get; set; }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We implementeren de conditionele call naar de FR api.</p>
</div>
<div class="paragraph">
<p>We proberen de url parameters zo veilig mogelijk af te handelen. Het betreft hier immers geen guids, maar wel vrije tekst die spaties en complexe karakters kan bevatten!</p>
</div>
<div class="listingblock">
<div class="title">ShipIt.Label.Api/Program.cs</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-c# hljs" data-lang="c#">app.MapPost("api/labels", async (
    IHttpClientFactory clientFactory,
    [FromBody] LabelRequestContract contract,
    IDomainController domain,
    IOptions&lt;LabelApiOptions&gt; options) =&gt; {

    var httpClient = clientFactory.CreateClient();

    // Fetch Price...

    // Validate Address (if FR)
    if(contract.RecipientCountry == "FR")
    {
        // Een set van url query parameters als Key Value
        var query = new Dictionary&lt;string, string&gt;
        {
            { "q", contract.RecipientAddressLine1
                + " " + contract.RecipientAddressLine2 },
            { "limit", "1"}
        };
        // Url encoding van speciale karakters
        var queryString = await new FormUrlEncodedContent(query).ReadAsStringAsync();
        // Url string validatie
        var frUri = new Uri($"{options.Value.FRApiBaseUrl}?{queryString}");

        var addressResponse = await httpClient
            .GetFromJsonAsync&lt;AddressResponseContract&gt;(frUri);

        if(addressResponse.Features[0].Properties.Score &lt; 0.6)
            throw new ArgumentException("Adres lijkt nergens op");
    }

    if(quoteResponse.ValidUntil &lt; DateTime.UtcNow)
        throw new Exception("quote too old.");
    //...
});</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_oefening"><a class="anchor" href="#_oefening"></a>Oefening</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Probeer zelf de taken van deze week te implementeren. Je kan steeds kijken naar de code uit de les als je vast loopt.</p>
</li>
<li>
<p>Informeer je online over gratis/opendata api&#8217;s die nuttig zouden kunnen zijn voor jouw opdracht.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_referenties"><a class="anchor" href="#_referenties"></a>Referenties</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://adresse.data.gouv.fr/api-doc/adresse">Api Adresse</a></p>
</li>
</ul>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
    <p>This page was built using a customized version of the Antora default UI. The source code for the default UI is licensed under the terms of the MPL-2.0 license.</p>
    <p>Course material may *not* be used to teach, tutor, coach, or present without obtaining explicit consent from Stefan Courteaux.</p>
</footer><script id="site-script" src="../_/js/site.js" data-ui-root-path="../_"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
