<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Testing Pyramid :: Programmeren Gevorderd 3 (BETA)</title>
    <meta name="generator" content="Antora 3.1.14">
    <link rel="stylesheet" href="../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="#">Programmeren Gevorderd 3 (BETA)</a>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
      
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
          <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="#">Producten</a>
              <div class="navbar-dropdown">
                  <a class="navbar-item" target="_blank" href="https://learn.microsoft.com/en-us/cli/azure/">Azure CLI</a>
                  <a class="navbar-item" target="_blank" href="https://www.docker.com/products/docker-desktop">Docker Desktop</a>
                  <a class="navbar-item" target="_blank" href="https://desktop.github.com/download">GitHub Desktop</a>
                  <a class="navbar-item" target="_blank" href="https://www.mysql.com/products/workbench">MySQL Workbench</a>
                  <a class="navbar-item" target="_blank" href="https://www.postman.com/downloads/">Postman</a>
                  <a class="navbar-item" target="_blank" href="https://www.jetbrains.com/rider/download">Rider</a>
                  <a class="navbar-item" target="_blank" href="https://code.visualstudio.com/download">VS Code</a>
              </div>
          </div>
          <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="#">Diensten</a>
              <div class="navbar-dropdown">
                  <a class="navbar-item" target="_blank" href="https://dev.azure.com/hogent-web4-stefancourteaux/">Azure DevOps</a>
                  <a class="navbar-item" target="_blank" href="https://portal.azure.com">Azure Portal</a>
                  <a class="navbar-item" target="_blank" href="https://chamilo.hogent.be">Chamilo</a>
                  <a class="navbar-item" target="_blank" href="https://github.com">GitHub</a>
                  <a class="navbar-item" target="_blank" href="https://jwt.io">JWT.io</a>                  
                  <a class="navbar-item" target="_blank" href="https://dotnet.microsoft.com">MS Docs</a>
              </div>
          </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="pg3" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="index.html">Gevorderd 3</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">ShipIt App üì¶Ô∏è</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-cloud-connected.html">Cloud Connected</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-microservices.html">Microservices</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-az-devops.html">Iteratief Ontwikkelen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-cosmos.html">Cosmos &amp; Options Pattern</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="07-blob.html">Blob Storage &amp; PDF</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-middleware.html">Middleware &amp; Extensions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="08-open-data-2526.html">Open Data</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="09-auth-2526.html">Authenticatie</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="09-auth-2526-2.html">Autorisatie</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="10-technisch.html">Technische Lessen</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="08-docker-2526.html">Docker</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="06-02-secret-management.html">Secret Management</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="08-testing-2526.html">Testing Pyramid</a>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">CI/CD</span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="80-lesopnames-2526S2.html">Lesopnames üì∫</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="00-geen-toegang.html">Geen Azure Toegang üò±</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="03-git.html">Git Gebruik ü•≤</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="99-tips.html">Extra Referenties üßê</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Gevorderd 3</span>
    <span class="version"></span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="index.html">Gevorderd 3</a></div>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Gevorderd 3</a></li>
    <li><a href="10-technisch.html">Technische Lessen</a></li>
    <li><a href="08-testing-2526.html">Testing Pyramid</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Testing Pyramid</h1>
<div class="sect1">
<h2 id="_introductie"><a class="anchor" href="#_introductie"></a>Introductie</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Hier zouden we ons kunnen voornemen een test te schrijven voor elke laag van de <em>Testing Pyramid</em>. Klinkt goed, maar zoals we intussen gewend zijn van softwareontwerp en architectuur is dit een vaag begrip dat door verschillende guru&#8217;s in de IT-wereld anders ingevuld wordt.</p>
</div>
<div class="paragraph">
<p>Naargelang het materiaal dat je raadpleegt, zal deze pyramide meer of minder lagen hebben die anders afgelijnd zijn. Occasioneel is men zelfs zo creatief mensen, wolken en euro&#8217;s bij de pyramide te tekenen. <em>It`s a free world.</em> Laat ons eerlijk zijn met onszelf en niet spreken van d√© <em>Testing Pyramid</em>, maar wel van een <em>Testing Pyramid</em>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Onderaan de pyramide organiseren we testen met hoge granulariteit. Denk aan fijnmazige unit tests die √©√©n enkele methode in isolatie testen.</p>
</li>
<li>
<p>Bovenaan de pyramide plaatsen we api testen. Deze hebben een lage granulariteit.</p>
</li>
<li>
<p>Tussenin voorzien we component of component-integratie testen. Daarin zal <em>mocking</em> gebeuren. Hoeveel, hangt af van hoe je de grenzen van de lagen van de pyramide bepaalt.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Het lanceren van een test onderaan de pyramide, zal zeer weinig code coveren. Het lanceren van een test bovenaan de pyramide, zal veel code coveren.</p>
</div>
<div class="paragraph">
<p>Je ziet dat we de test coverage van een solution snel kunnen opkrikken door api tests te schrijven, gezien deze impliciet veel code coveren. Is dat een geldige aanpak om de coverage hoog te krijgen? Hangt ervan af aan wie je het vraagt, maar ik neig naar "nope".</p>
</div>
<div class="paragraph">
<p>De api tests <em>hitten</em> de code strik genomen wel, maar unit tests dekken snel meer (edge) cases af.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Een <code>[Theory]</code> set zal zeer veel variaties voor een unit test voorzien.</p>
</li>
<li>
<p>We voorzien meerdere unit test invalshoeken per methode.</p>
</li>
<li>
<p>Hogerop in de pyramide gaat men typisch niet de nodige variaties (kunnen) voorzien om alle individuele methode edge cases in de stack te controleren.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_voorbeeld"><a class="anchor" href="#_voorbeeld"></a>Voorbeeld</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Een <a href="https://dev.azure.com/hogent-web4-stefancourteaux/_git/PipelinesGent">voorbeeldsolution</a> is beschikbaar in het Azure DevOps repo.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Het systeem dat getest wordt (SUT - System Under Test) bevat <strong>geen</strong> code paden die specifiek bedoeld zijn om gebruikt te worden tijdens het uitvoeren van testen.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/pipelines/pyramid.png" alt="pyramid">
</div>
</div>
<div class="paragraph">
<p>De meest gebruikte test libraries voor .Net zijn <em>XUnit</em>, <em>NUnit</em> en <em>MSTest</em>. Je zou kunnen stellen dat <em>MSTest</em> de standaard is gezien dit aangeleverd wordt door Microsoft, maar in de praktijk gebruiken de meeste teams XUnit.</p>
</div>
<div class="paragraph">
<p>VS Code heeft prima ondersteuning voor het visualiseren van test runs.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/pipelines/tests.png" alt="tests">
</div>
</div>
<div class="sect2">
<h3 id="_unit_tests"><a class="anchor" href="#_unit_tests"></a>Unit Tests</h3>
<div class="paragraph">
<p>Het project <code>StefanPipelinesDemo.Services.Models.Tests</code> bevat voorbeeld unit tests. Dit werd gebouwd op de <code>xunit</code> dotnet template.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public class DemoModelTests_Unit
{
    [Theory] <i class="conum" data-value="1"></i><b>(1)</b>
    [InlineData("Test", "TestTest")]
    [InlineData("123", "123123")]
    [InlineData("Chloorfluorkoolwaterstofverbinding", "ChloorfluorkoolwaterstofverbindingChloorfluorkoolwaterstofverbinding")]
    public void GivenAnyInputString_WhenInitializingModel_ThenDuplicatedValueMatches <i class="conum" data-value="2"></i><b>(2)</b>
    (string input, string expected)
    {
        // Arrange <i class="conum" data-value="3"></i><b>(3)</b>
        var model = new DemoModel
        {
            SomeProp = input
        };

        // Act <i class="conum" data-value="3"></i><b>(3)</b>
        var actual = model.GetDuplicatedPropValue();

        // Assert <i class="conum" data-value="3"></i><b>(3)</b>
        Assert.Equal(expected, actual);
    }

    // ...
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Test zal meerdere keren runnen met andere data.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Naam van de test. Gebruikt <a href="https://martinfowler.com/bliki/GivenWhenThen.html">Given-When-Then</a> naamgeving.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>De test volgt het <a href="https://automationpanda.com/2020/07/07/arrange-act-assert-a-pattern-for-writing-good-tests/">Arrange-Act-Assert</a> patroon.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public class DemoModelTests_Unit
{
    // ...

    [Fact]
    public void GivenModelWithoutId_WhenMappingToContract_ShouldThrow()
    {
        // Arrange
        var model = new DemoModel
        {
            SomeProp = "breakme"
        };

        // Act
        void action() =&gt; model.AsContract(); <i class="conum" data-value="1"></i><b>(1)</b>

        // Assert
        Assert.Throws&lt;IdExpectedMappingException&gt;(action);
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Dit is geen "echte" act, wel een declaratie van de act logica. Alternatief is Act &amp; Assert in √©√©n stap doen. Let op: dit is geen specifieke xunit of testing syntax.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_component"><a class="anchor" href="#_component"></a>Component</h3>
<div class="paragraph">
<p>Het project <code>StefanPipelinesDemo.Services.Tests</code> bevat voorbeeld component tests. Dit werd gebouwd op de <code>xunit</code> dotnet template en <a href="https://github.com/devlooped/moq">Moq</a>.</p>
</div>
<div class="paragraph">
<p>Wanneer je het gedrag van een component, typisch een <em>service</em> of <em>manager</em>, wil testen, zal je snel ondervinden dat je impliciet al de dependencies van die service ook aan het testen bent. Dit opzetten en correct beheren is niet evident, en schiet het doel voorbij. We willen enkel de relevante code <em>hitten</em>.</p>
</div>
<div class="paragraph">
<p>Een handige manier om de service is te isoleren, is de dependencies te vervangen door <em>fake</em> versies. De <code>DemoService</code> verwacht een object dat de <code>IDemoRepository</code> interface respecteert. Dit laat een opening om een zelfgeschreven implementatie-variant te voorzien die we gebruiken tijdens het testen.</p>
</div>
<div class="paragraph">
<p>Een <em>fake</em> implementatie bouwen en meegeven, heet <em>mocking</em>, "imiteren" in het Nederlands. Denk aan <em>mockingbird</em> ofte <em>spotlijster</em>, die de zang van andere vogels imiteert. Gezien we verre van de eerste dotnet developers zijn die nood hebben aan mocking, kunnen wij steunen op de indrukwekkende <code>Moq</code> nuget.</p>
</div>
<div class="paragraph">
<p>Moq laat ons toe te vertrekken van een bestaande interface (of klasse) en deze te (her)implementeren naar wens, zonder expliciet nieuwe klassen te moeten schrijven. De implementatie kan zeer high level of zeer gedetailleerd zijn. Ook kunnen we aan een Moq vragen of een bepaalde methode aangeroepen werd.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public void GivenANonExistingId_WhenGettingAnObject_ThenReturnsNullGracefully()
{
    // Arrange
    var repositoryMock = new Mock&lt;IDemoRepository&gt;(); <i class="conum" data-value="1"></i><b>(1)</b>
    repositoryMock.Setup(m =&gt; m.Read(It.IsAny&lt;int&gt;())) <i class="conum" data-value="2"></i><b>(2)</b>
        .Returns((DemoStorageModel?)null); <i class="conum" data-value="3"></i><b>(3)</b>

    var service = new DemoService(repositoryMock.Object); <i class="conum" data-value="4"></i><b>(4)</b>

    const int id = 1337;

    // Act
    var result = service.GetDemo(id); <i class="conum" data-value="5"></i><b>(5)</b>

    // Assert 1 - Is het resultaat wel degelijk null?
    Assert.Null(result); <i class="conum" data-value="6"></i><b>(6)</b>
    // Assert 2 - Heeft de service exact 1 call gemaakt naar de repo?
    repositoryMock.Verify(m =&gt; m.Read(id), Times.Exactly(1)); <i class="conum" data-value="7"></i><b>(7)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Nieuwe mock op basis bestaand type.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>De <code>Read(int id)</code> methode wordt ge√Ømplementeerd. Alle input ok zolang het een <code>int</code> is.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Return type is <code>DemoStorageModel?</code> en waarde <code>null</code>. Bij ingevulde return waardes kan het type vanzelf afgeleid worden.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>De <code>DemoService</code>, klasse die we willen testen, wordt aangemaakt. Deze krijgt het mock <strong>object</strong> mee.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>De service methode wordt aangeroepen.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Standaard assert controleert of de return waarde inderdaad leeg is.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Controleren of service die getest wordt wel degelijk de repository exact 1 keer aanriep.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Moq kent veel mogelijkheden. Bekijk zeker de documentatie wanneer je iets complexer wil doen. De kans is zeer groot dat je ingebouwde functionaliteit kan gebruiken om je doel te bereiken.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_api"><a class="anchor" href="#_api"></a>Api</h3>
<div class="paragraph">
<p>In het verleden was Api testing inrichting geen evidentie. Tegenwoordig is het <em>gemakkelijk</em> dankzij <code>Microsoft.AspNetCore.Mvc.Testing</code> dewelke <code>WebApplicationFactory</code> aanlevert. Deze factory laat ons toe ad hoc een api service te starten op basis van elders gedefinieerde, op <code>WebApplicationBuilder</code> gebaseerde, api bootstrapping.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Het is perfect mogelijk dat je op stage merkt dat men in het bedrijf <code>Microsoft.AspNetCore.Mvc.Testing</code> (nog) niet gebruikt. Men zal desgevallend absolute draken van code geschreven hebben om hetzelfde resultaat te bekomen. Fü´°
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public class ApiTests(WebApplicationFactory&lt;Program&gt; factory) :
    IClassFixture&lt;WebApplicationFactory&lt;Program&gt;&gt;
{
    [Fact]
    public async Task GivenId1_WhenGettingSingle_ShouldReturnExpectedEquivalent()
    {
        // Arrange
        var client = factory.CreateClient();
        var expected = new DemoResponseContract(1, "SomeValue");

        // Act
        var response = await client.GetAsync("/demos/1");
        var responseCode = response.StatusCode;
        var responseContent = await response.Content
            .ReadFromJsonAsync&lt;DemoResponseContract&gt;();

        // Assert
        Assert.Equal(System.Net.HttpStatusCode.OK, responseCode);
        Assert.Equivalent(expected, responseContent);
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_databases"><a class="anchor" href="#_databases"></a>Database(s)?</h3>
<div class="paragraph">
<p>Horen we de database te betrekken bij geautomatiseerde testen? Een online zoekopdracht of Copilot prompt zal al snel resulteren in een blokje code om een <code>DbContext</code> te overschrijven met een <code>InMemoryDatabase</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Microsoft.EntityFrameworkCore.InMemory</code> nugetje,</p>
</li>
<li>
<p><code>Ctrl+C</code>, <code>Ctrl-V</code>,</p>
</li>
<li>
<p>&#8230;&#8203;en het is klaar.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Maar is dat wel logisch? Wat zegt een <a href="https://learn.microsoft.com/en-us/ef/core/testing/">primaire bron</a> daarover?</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>The <strong>in-memory provider</strong> will not behave like your real database in many important ways. Some features cannot be tested with it at all (e.g. transactions, raw SQL..), while other features may behave differently than your production database (e.g. case-sensitivity in queries). While in-memory can work for simple, constrained query scenarios, it is highly limited and <strong>we discourage its use</strong>.
<strong>Mocking DbSet</strong> for querying is complex and difficult, and suffers from the same disadvantages as the in-memory approach; <strong>we discourage this as well</strong>.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; https://learn.microsoft.com/en-us/ef/core/testing/
</div>
</div>
<div class="paragraph">
<p>Het gebruik van <code>InMemoryDatabase</code> om een applicatie te testen die in werkelijkheid op een persistente database (MS SQL Server, MySQL, etc.) steunt, wordt ten stelligste afgeraden.</p>
</div>
<div class="paragraph">
<p>Wanneer men dit advies in de wind slaat, zal er code in het project sluipen die dient om rond de beperkingen van <code>InMemoryDatabase</code> te werken. Deze code wordt enkel gebruikt tijdens het testen. Hieruit volgt dat de code die in productie  effectief uitgevoerd zal worden, buiten de testen valt. Oops.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Dit is een mooi voorbeeld van een situatie waarin een llm gretig code <em>kakt</em> en zodoende jouw kansen verkleint een waardevolle redenering op te bouwen.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Microsoft weerhoudt twee opties.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Repository Pattern</dt>
<dd>
<p>Injecteer de <code>DbContext</code> niet rechtstreeks in Services of ApiControllers, maar abstraheer deze weg achter, jawel, Repositories. De repositories kan je <em>uitmocken</em> tijdens het testen. In dit scenario wordt er geen echte database gebruikt tijdens het testen. <strong>Op school is dit de target.</strong></p>
</dd>
<dt class="hdlist1">Echte Database</dt>
<dd>
<p>Voorzie een echte database waartegen de testen uitgevoerd zullen worden. In dit scenario wordt alle code getest die in een productiescenario uitgevoerd zou worden. Er is immers geen wezenlijk verschil. Enkel de <code>ConnectionString</code> zou kunnen verschillen. Deze aanpak levert de meest waardevolle resultaten en <a href="https://learn.microsoft.com/en-us/ef/core/testing/choosing-a-testing-strategy#summary">geniet dus de voorkeur</a> in een bedrijf die de middelen heeft om alles mooi in te richten. <strong>Op school is dit niet realistisch.</strong></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Een bedrijf zal typisch een aantal verschillende omgevingen beheren waar de software-aanpassingen doorvloeien. Development, Test, Acceptatie, Productie etc. Men kan automatische (geanonimiseerde) database dumps en imports voorzien om in andere omgevingen dan Productie een representatieve situatie te cre√´ren.</p>
</div>
<div class="paragraph">
<p>Voorbeeld:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Export Productie Db</p>
</li>
<li>
<p>Overschrijf Test Db</p>
</li>
<li>
<p>Voer Migrations uit op Test Db</p>
</li>
<li>
<p>Voer testen uit op test Db</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Wanneer je testen herhaaldelijk wil uitvoeren, kan data van voorgaande executies in de weg komen te zitten. Je let er dus best op steeds een elegante <em>teardown</em> te voorzien zodat de omgeving na het uitvoeren van een test opgeruimd wordt voor de volgende test.</p>
</div>
<div class="paragraph">
<p>Deze operaties kunnen ook volledig in een pipeline opgenomen worden. Stel je voor: Db dumps downloaden naar de Build Agent, daarin een Docker opspinnen met, bijvoorbeeld, MySQL, de dump importeren, de connectionstring in de codebase (of environment) duwen, alle testen uitvoeren, resultaten rapporteren aan Azure DevOps en dan de Build Agent gewoon laten recycleren zonder een permanent spoor van deze virtuele infrastructuur na te laten. Het kan allemaal.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_oefening"><a class="anchor" href="#_oefening"></a>Oefening</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Probeer zelf de taak van de week te implementeren. Je kan steeds kijken naar de code uit de les als je vast loopt.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_referenties"><a class="anchor" href="#_referenties"></a>Referenties</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://learn.microsoft.com/en-us/azure/devops/pipelines/?view=azure-devops">Pipelines</a></p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
    <p>This page was built using a customized version of the Antora default UI. The source code for the default UI is licensed under the terms of the MPL-2.0 license.</p>
    <p>Course material may *not* be used to teach, tutor, coach, or present without obtaining explicit consent from Stefan Courteaux.</p>
</footer><script id="site-script" src="../_/js/site.js" data-ui-root-path="../_"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
